/// Calculation group used to dynamically apply time-based logic (e.g., Previous Month, Year-to-Date, Growth %) to any measure selected in a report visual.
table 'Time Intelligence'
	isHidden
	lineageTag: c00389d2-9621-4e72-a01f-e33252b9e388

	calculationGroup

		calculationItem 'Previous Month' =
				CALCULATE(
				    SELECTEDMEASURE(),
				    DATEADD('Date'[Date], -1, MONTH)
				)

		calculationItem Current = SELECTEDMEASURE()

		calculationItem 'MoM Growth %' =
				
				VAR CurrentVal = SELECTEDMEASURE()
				VAR PrevVal = CALCULATE(SELECTEDMEASURE(), DATEADD('Date'[Date], -1, MONTH))
				RETURN
				    IF(
				        NOT ISBLANK(CurrentVal) && NOT ISBLANK(PrevVal),
				        DIVIDE(CurrentVal - PrevVal, PrevVal, 0)
				    )

			formatStringDefinition = "0.0%"

		calculationItem YTD =
				
				CALCULATE(
				    SELECTEDMEASURE(),
				    DATESYTD('Date'[Date])
				)

	column 'Time Period'
		dataType: string
		isHidden
		lineageTag: 9fdc1099-2971-457d-a1e7-3c30eeaa5e3e
		summarizeBy: none
		sourceColumn: Name
		sortByColumn: Ordinal

		annotation SummarizationSetBy = Automatic

		annotation BestPracticeAnalyzer_IgnoreRules = {"RuleIDs":["UNNECESSARY_COLUMNS"]}

	column Ordinal
		dataType: int64
		isHidden
		formatString: 0
		lineageTag: 8a01fa68-fb25-435c-9e82-f29fbe0f1736
		summarizeBy: none
		sourceColumn: Ordinal

		annotation SummarizationSetBy = Automatic

